---
title: "On the waning of forms - a corpus-based analysis of losers in language change (Part 3)"
author: "Martin Schweinberger"
date: "`r format(Sys.time(), '%Y-%m-%d')`"
output:
  bookdown::html_document2: default
bibliography: bibliography.bib
link-citations: yes
---

```{r uq1, echo=F, fig.cap="", message=FALSE, warning=FALSE, out.width='100%'}
knitr::include_graphics("https://slcladal.github.io/images/isle6.png")
```

This document documents the analysis of the adjective amplifier *very* in New Zealand English. The analysis was performed with the aim of fitting a generalized-linear binomial logistic mixed-effects regression to explain which factors correlate with the use of *very* and to ascertain if 

1. *very* is decreasing across apparent time 

2. if the decrease of *very* is systematic or layered (which would imply that the use of very is stratified along linguistic and social lines) or unsystematic (which would imply that it correlates with few if any linguistic or social variables). 

# Introduction

We will now begin with the analysis. In a first step, the session is prepared by setting options and activating packages.

```{r isle6_3_01, message=F, warning=F}
# load packages
library(tidyverse)
library(tidyr)
# set options
options(stringsAsFactors = F)
options(scipen = 999)
options(max.print=10000)
```

We proceed by loading the data, factorizing variables that are so far represented as character strings instead of factors, and inspecting its characteristics.

```{r isle6_3_02, message=F, warning=F}
# load data
verywsc <- read.delim(here::here("data", "ampwsc_regdat.txt"), sep = "\t", header = T, skipNul = T)
# remove superfluous variables
verywsc <- verywsc %>%
  dplyr::filter(Variant != "0") %>%
  dplyr::select(-ID, -FileSpeaker, -Speaker, -File, -Age_original, -Variant) %>%
  # convert to title format
  dplyr::mutate(Ethnicity = stringr::str_to_title(Ethnicity),
                L1 = stringr::str_to_title(L1),
                Emotionality = stringr::str_to_title(Emotionality)) %>%
  # convert charaters to factors
  dplyr::mutate_if(is.character, factor)
# inspect data
nrow(verywsc); str(verywsc); head(verywsc); summary (verywsc)
```

We will now scale numeric variables so that the estimates refer to the mean of the numeric variables rather than their true 0-point. This is necessary as estimates for adjectives that occur with a frequency of 0 are nonsensical.

```{r isle6_3_03, message=F, warning=F}
# frequency
summary(verywsc$Frequency)
verywsc <- verywsc %>%
  dplyr::mutate(Frequency  = scale(Frequency)) %>%
  dplyr::mutate(Frequency = as.vector(Frequency))
# inspect
summary(verywsc$Frequency)
```

We plot the scaled variable (Frequency).

```{r isle6_3_05, message=F, warning=F}
plot(verywsc$Frequency)
```

We also scale gradability and plot the resulting scaled gradability.

```{r isle6_3_07, message=F, warning=F}
# gradability
verywsc <- verywsc %>%
  dplyr::mutate(Gradability  = scale(Gradability-1)) %>%
  dplyr::mutate(Gradability = as.vector(Gradability))
# summarize gradability
summary(verywsc$Gradability)
# visualize gradability
plot(verywsc$Gradability)
```

# CIT

```{r isle6_3_08, message=F, warning=F}
# load packages
library(partykit)
library(tidyverse)
# create data
citdata <- verywsc
# set seed
set.seed(111) 
# apply bonferroni correction (1 minus alpha multiplied by n of predictors)
control = ctree_control(mincriterion = 1-(.05*ncol(citdata)-1))
# create initial conditional inference tree model
citd.ctree <- partykit::ctree(very ~ Age +  SemanticCategory + Frequency +  Priming + 
                                Type + Emotionality  + Gender + L1 + Function, data = citdata)
plot(citd.ctree, gp = gpar(fontsize = 8)) # plot final ctree
```

```{r isle6_3_09, message=F, warning=F}
citd.ctree
```

According to the CIT, we can simplify Semantic Category, Type, and Age. However, we will only collapse categories that are conceptually related (collapse Speed, Position, and Dimension as well as Physical Property and Color) 

```{r isle6_3_10, message=F, warning=F}
verywsc <- verywsc %>%
  # simplify age
  dplyr::mutate(Age = as.character(Age)) %>%
  dplyr::mutate(Age = dplyr::case_when(Age == "16-19" ~ "16-29",
                                       Age == "20-29" ~ "16-29",
                                       Age == "40-49" ~ "40+",
                                       Age == "50-59" ~ "40+",
                                       Age == "60+" ~ "40+",
                                       TRUE ~ Age)) %>%
  # simplify type
  dplyr::mutate(Type = as.character(Type)) %>%
  dplyr::mutate(Type = dplyr::case_when(Type == "Conversation" ~ "Private",
                                        Type == "TelephoneConversation" ~ "Private",
                                        Type == "BroadcastInterview" ~ "Public",
                                        Type == "Lecture" ~ "Public",
                                        Type == "OralHistoryInterview" ~ "Public",
                                        Type == "ParliamentaryDebate" ~ "Public",
                                        Type == "RadioTalkback" ~ "Public",
                                        Type == "SportsCommentary" ~ "Public",
                                        Type == "BroadcastNews" ~ "Formal",
                                        Type == "SocialDialectInterview" ~ "Formal",
                                        Type == "TeacherMonologue" ~ "Formal",
                                        Type == "TransactionsAndMeetings" ~ "Formal",
                                        Type == "BroadcastMonologue" ~ "Formal",
                                        Type == "BroadcastWeather" ~ "Formal",
                                        TRUE ~ Type)) %>%
  # simplify semantic category
  dplyr::mutate(SemanticCategory = as.character(SemanticCategory)) %>%
  dplyr::mutate(SemanticCategory = dplyr::case_when(SemanticCategory == "Speed" ~ "Dimension",
                                                    SemanticCategory == "Position" ~ "Dimension",
                                                    SemanticCategory == "Color" ~ "PhyProperty",
                                                    SemanticCategory == "PhysicalProperty" ~ "PhyProperty",
                                                    SemanticCategory == "HumanPropensity" ~ "Human",
                                                    TRUE ~ SemanticCategory)) %>%
  # simplify Ethnicity
    dplyr::mutate(Ethnicity = as.character(Ethnicity)) %>%
  dplyr::mutate(Ethnicity = dplyr::case_when(Ethnicity == "Maori/Pakeha" ~ "Other",
                                             TRUE ~ Ethnicity)) %>%
  # round Frequency
  dplyr::mutate(Frequency = round(Frequency, 5)) %>%
  # round Gradability
  dplyr::mutate(Gradability = round(Gradability, 5)) %>%
  # factorize
  dplyr::mutate(Age = factor(Age),
                Type = factor(Type),
                SemanticCategory = factor(SemanticCategory),
                Ethnicity = factor(Ethnicity))
# inspect
table(verywsc$SemanticCategory)
table(verywsc$Age)
table(verywsc$Type)
table(verywsc$Ethnicity)
```

```{r isle6_3_08, message=F, warning=F}
# create data
citdata <- verywsc
# set seed
set.seed(111) 
# apply bonferroni correction (1 minus alpha multiplied by n of predictors)
control = ctree_control(mincriterion = 1-(.05*ncol(citdata)-1))
# create initial conditional inference tree model
citd.ctree <- partykit::ctree(very ~ Age +  SemanticCategory + Frequency +  Priming + 
                                Type + Emotionality  + Gender + L1 + Function, data = citdata)
plot(citd.ctree, gp = gpar(fontsize = 8)) # plot final ctree
```

```{r}
# activate package
library(ggparty)
# extract p-values
pvals <- unlist(nodeapply(citd.ctree, ids = nodeids(citd.ctree), function(n) info_node(n)$p.value))
pvals <- pvals[pvals <.05]
# plotting
ggparty(citd.ctree) +
  geom_edge() +
  geom_edge_label() +
  geom_node_label(line_list = list(aes(label = splitvar),
                                   aes(label = paste0("N=", nodesize, ", p", 
                                                      ifelse(pvals < .001, "<.001", paste0("=", round(pvals, 3)))), 
                                       size = 13)),
                  line_gpar = list(list(size = 13), 
                                   list(size = 13)), 
                  ids = "inner") +
  geom_node_label(aes(label = paste0("Node ", id, ", N = ", nodesize)),
    ids = "terminal", nudge_y = -0.0, nudge_x = 0.01) +
  geom_node_plot(gglist = list(
    geom_bar(aes(x = "", fill = very),
             position = position_fill(), color = "black"),
      theme_minimal(),
      scale_fill_manual(values = c("gray50", "gray80"), guide = FALSE),
      scale_y_continuous(breaks = c(0, 1)),
    xlab(""), 
    ylab("Probability"),
    geom_text(aes(x = "", group = very,
                  label = stat(count)),
              stat = "count", position = position_fill(), vjust = 1.1)),
    shared_axis_labels = TRUE) +
  ggsave(file =  here::here("images", "Cit_very.png"), 
         width = 60, height = 30, units = c("cm"),  dpi = 600)
```

# Boruta

We now begin with the modeling. In a first step, we use a Boruta analysis as a variable selection procedure to determine which variables have any sort of meaningful relationship with the dependent variable. We will only consider variables which have been deemed as being important during the model fitting process.

```{r isle6_3_11}
# load library
library(Boruta)
# create data for boruta
borutadata <- verywsc %>%
  na.omit()
# save and load data
write.table(borutadata, here::here("data", "borutadata.txt"), sep = "\t", 
            col.names = T, row.names = F, quote = F)
# run 1
set.seed(2019121201)
boruta1 <- Boruta(very ~.,data=borutadata)
print(boruta1)
```

As Function is deemed unimportant, we remove it from the analysis and rerun the variable selection procedure.

We now begin with the modelling. In a first step, we use a Boruta analysis as a variable selection procedure to determine which variables have any sort of meaningful relationship with the dependent variable.

```{r isle6_3_12}
rejected <- names(boruta1$finalDecision)[which(boruta1$finalDecision == "Rejected")]
# update data for boruta
borutadata <- borutadata %>%
  dplyr::select(-rejected)
# run 2
set.seed(2019121202)
boruta2 <- Boruta(very ~.,data=borutadata)
print(boruta2)
```

We also remove Education as it is deemed only tentatively important and start a 3^rd^ run.

```{r isle6_3_13}
rejected <- names(boruta1$finalDecision)[which(boruta1$finalDecision == "Tentative")]
# update data for boruta
borutadata <- borutadata %>%
  dplyr::select(-rejected)
# run 3
set.seed(2019121203)
boruta3 <- Boruta(very ~., data=borutadata)
print(boruta3)
```

No more variables need to be removed. We now inspect the visualizations of the Boruta analysis. 

```{r isle6_3_14, message=F, warning=F}
plot(boruta3)
```

In addition, we inspect the history of the Boruta runs. 

```{r isle6_3_15, message=F, warning=F}
plotImpHistory(boruta3)
```

Now, we create the final publication visualization of the Boruta analysis. 

```{r isle6_3_16, message=F, warning=F}
borutadf <- as.data.frame(boruta3$ImpHistory) %>%
  gather(Variable, Importance, Adjective:shadowMin) %>%
  mutate(Type = ifelse(str_detect(Variable, "shadow"), "Control", "Predictor")) %>%
  mutate(Type = factor(Type),
         Variable = factor(Variable))
ggplot(borutadf, aes(x = reorder(Variable, Importance, mean), y = Importance, fill = Type)) + 
  geom_boxplot() +
  geom_vline(xintercept=3.5, linetype="dashed", color = "black") +
  scale_fill_manual(values = c("gray80", "gray40")) +
  theme_bw() + 
  theme(legend.position = "top",
        axis.text.x = element_text(angle=90)) +
  labs(x = "Variable") +
  ggsave(file =  here::here("images", "Boruta.png"), 
         width = 15, height = 10, units = c("cm"),  dpi = 600)
```

Potentially relevant predictors are:

* Age
* SemanticCategory
* Frequency
* Priming
* Type
* Emotionality
* Adjective
* Gender
* Ethnicity
* Education
* Gradability

# Mixed-Effects Model

We begin with the model fitting by setting options and creating intercept-only base-line models. 

```{r isle6_3_17, message=F, warning=F}
# load library
library(rms)
# set options
options(contrasts  =c("contr.treatment", "contr.poly"))
verywsc.dist <- datadist(verywsc)
options(datadist = "verywsc.dist")
# generate initial minimal regression model 
m0.glm = glm(very ~ 1, family = binomial, data = verywsc) 
# inspect results
summary(m0.glm)
```

In a next step, we create analogous base-line models with Adjective as a random effect (random intercepts). 

```{r isle6_3_18, message=F, warning=F}
# load packages
library(lme4)
library(car)
# create model with a random intercept for Adjective
m0.glmer = glmer(very ~ (1|Adjective), data = verywsc, family = binomial)
```

We can now use the AIC to determine if including a random effect structure is justified. 

```{r isle6_3_19, message=F, warning=F}
aic.glmer <- AIC(logLik(m0.glmer))
aic.glm <- AIC(logLik(m0.glm))
aic.glmer; aic.glm
```

The AIC of the glmer object is substantially smaller which indicates that including the random intercepts appears to be justified. 

## Model fitting{-}

#### Age {-}

```{r isle6_3_20}
#	manual modelfitting
m0.glmer <- glmer(very ~ 1 + (1|Adjective), family = binomial, data = verywsc, 
                  control=glmerControl(optimizer="bobyqa"))
# add Age
ifelse(min(ftable(verywsc$Age, verywsc$very)) == 0, "not possible", "possible")
m1.glmer <- update(m0.glmer, .~.+Age)
anova(m0.glmer, m1.glmer, test = "Chi")
Anova(m1.glmer, type = "III", test = "Chi")
```

Probability of very among speakers aged 40+

```{r isle6_3_21}
round(plogis(fixef(m1.glmer)[1] + fixef(m1.glmer)[3])*100, 2)
```

We will now check if the sample size is sufficient to detect a medium-sized effect (Cohen's d 0.5) - the traditional scale is 0.2 for a small, 0.5 for medium-sized, and 0.8 for a large or strong effect. 

In order to check what a medium-sized effect is, we need to determine the odds ratios of the fixed effects and then convert them into Cohen's d values for which we have associations between traditional denominations (small, medium, and large) and effect sife values. According to @chen2010big odds ratios of 1.68, 3.47, and 6.71 are equivalent to Cohen's d = 0.2 (small), 0.5 (medium), and 0.8 (large).

```{r isle6_3_22, message=F, warning=F}
pm1 <- m1.glmer
estimatesfixedeffects <- fixef(pm1)
exp(estimatesfixedeffects)
```

We will now change the size of the effect of Age40+ to make it "medium-sized", i.e. on the brink of being noise but being just strong enough to be considered small. In other words, we will set the effect so that its odds ratio is exactly 3.47.

```{r isle6_3_23, eval = F}
fixef(pm1)["Age40+"] <- 1.244
estimatesfixedeffects <- fixef(pm1)
exp(estimatesfixedeffects)
simr::powerSim(pm1, fixed("Age", "lr"), nsim=100)
```

#### Frequency {-}

```{r isle6_3_24}
# add Frequency
m2.glmer <- update(m1.glmer, .~.+ Frequency)
car::vif(m2.glmer)
anova(m2.glmer, m1.glmer, test = "Chi") 
```

```{r isle6_3_25, eval = F}
pm2 <- m2.glmer
fixef(pm2)["Frequency"] <- 1.244
estimatesfixedeffects <- fixef(pm2)
simr::powerSim(pm2, fixed("Frequency", "lr"), nsim=100)
```

#### Priming{-}

```{r isle6_3_26}
ifelse(min(ftable(verywsc$Priming, verywsc$very)) == 0, "not possible", "possible")
m3.glmer <- update(m1.glmer, .~.+Priming)
car::vif(m3.glmer)
anova(m3.glmer, m1.glmer, test = "Chi")              
Anova(m3.glmer, type = "III", test = "Chi")
```

z-test because the predictor is nnot categorical

```{r isle6_3_27, eval = F}
pm3 <- m3.glmer
fixef(pm3)["PrimingPrime"] <- 1.244
estimatesfixedeffects <- fixef(pm3)
pm3_results <- simr::powerSim(pm3, fixed("PrimingPrime", "z"), nsim=100)
pm3_results
```

#### Emotionality{-}

```{r isle6_3_28}
ifelse(min(ftable(verywsc$Emotionality, verywsc$very)) == 0, "not possible", "possible")
m4.glmer <- update(m3.glmer, .~.+Emotionality)
car::vif(m4.glmer)
anova(m4.glmer, m3.glmer, test = "Chi")              
Anova(m4.glmer, type = "III", test = "Chi")        
```

```{r isle6_3_29, eval = F}
pm4 <- m4.glmer
fixef(pm4)["EmotionalityPositive"] <- 1.244 # positive because it has fewer observations
estimatesfixedeffects <- fixef(pm4)
pm3_results <- simr::powerSim(pm4, fixed("EmotionalityPositive", "z"), nsim=100)
pm3_results
```

#### Type{-}

```{r isle6_3_30}
ifelse(min(ftable(verywsc$Type, verywsc$very)) == 0, "not possible", "possible")
m5.glmer <- update(m4.glmer, .~.+Type)
car::vif(m5.glmer)
anova(m5.glmer, m4.glmer, test = "Chi") 
Anova(m5.glmer, type = "III", test = "Chi")   
```

```{r isle6_3_31, eval = F}
pm5 <- m5.glmer
fixef(pm5)["TypePublicConversation"] <- 1.244 # PublicConversation because it has fewer observations
estimatesfixedeffects <- fixef(pm5)
pm5_results <- simr::powerSim(pm5, fixed("TypePublicConversation", "z"), nsim=100)
pm5_results
```

#### Gender{-}

```{r isle6_3_32}
ifelse(min(ftable(verywsc$Gender, verywsc$very)) == 0, "not possible", "possible")
m6.glmer <- update(m5.glmer, .~.+Gender)
car::vif(m6.glmer)
anova(m6.glmer, m5.glmer, test = "Chi")              
Anova(m6.glmer, type = "III", test = "Chi")        
```

```{r isle6_3_33, eval = F}
pm6 <- m6.glmer
fixef(pm6)["GenderWoman"] <- 1.244 
estimatesfixedeffects <- fixef(pm6)
pm6_results <- simr::powerSim(pm6, fixed("GenderWoman", "z"), nsim=100)
pm6_results
```

#### Semantic Category{-}

```{r isle6_3_34}
m7.glmer <- update(m6.glmer, .~.+ SemanticCategory)
car::vif(m7.glmer)
anova(m7.glmer, m6.glmer, test = "Chi") 
```

```{r isle6_3_35, eval = F}
pm7 <- m7.glmer
fixef(pm7)["SemanticCategoryPhysicalProperty"] <- 1.244 # PhysicalProperty because it has fewer observations
estimatesfixedeffects <- fixef(pm7)
pm7_results <- simr::powerSim(pm7, fixed("SemanticCategoryPhysicalProperty", "z"), nsim=100)
pm7_results
```

#### Ethnicity{-}

```{r isle6_3_36}
ifelse(min(ftable(verywsc$Ethnicity, verywsc$very)) == 0, "not possible", "possible")
m8.glmer <- update(m6.glmer, .~.+Ethnicity)
car::vif(m8.glmer)
anova(m8.glmer, m6.glmer, test = "Chi")  
```

#### Education{-}

```{r isle6_3_37}
ifelse(min(ftable(verywsc$Education, verywsc$very)) == 0, "not possible", "possible")
m9.glmer <- update(m6.glmer, .~.+Education)
car::vif(m9.glmer)
anova(m9.glmer, m6.glmer, test = "Chi")       
```

```{r isle6_38, eval = F}
pm9 <- m9.glmer
fixef(pm9)["EducationUniversity"] <- 1.244 
estimatesfixedeffects <- fixef(pm9)
pm9_results <- simr::powerSim(pm9, fixed("EducationUniversity", "z"), nsim=100)
pm9_results
```

#### Gradability{-}

```{r isle6_3_39}
m10.glmer <- update(m6.glmer, .~.+Gradability)
car::vif(m10.glmer)
anova(m10.glmer, m6.glmer, test = "Chi")   
Anova(m10.glmer, type = "III", test = "Chi") 
```

```{r isle6_3_40, eval = F}
pm10 <- m10.glmer
fixef(pm10)["Gradability"] <- 1.244
estimatesfixedeffects <- fixef(pm10)
pm10_results <- simr::powerSim(pm10, fixed("Gradability", "z"), nsim=100)
pm10_results
```

## Interactions{-}

```{r isle6_3_41, message=F, warning=F}
# find all 2-way interactions
library(utils)
#colnames(verywsc) # remove # to activate
vars <- c("Age",  "SemanticCategory", "Frequency", "Priming",
          "Emotionality", "Type", "Gender", "Ethnicity", "Education",
          "Gradability")
intac <- t(combn(vars, 2))
intac
```

#### Check interactions

```{r isle6_3_m12}
ifelse(min(ftable(verywsc$Age, verywsc$SemanticCategory, verywsc$very)) == 0, "not possible", "possible")
m12.glmer <-  update(m10.glmer, .~.+ Age * SemanticCategory)
max(car::vif(m12.glmer)[,1])
# excessive vifs
```

```{r isle6_3_m13}
m13.glmer <-  update(m10.glmer, .~.+ Age * Frequency)
max(car::vif(m13.glmer)[,1])
anova(m13.glmer, m10.glmer, test = "Chi") 
Anova(m13.glmer, type = "III", test = "Chi") 
```

```{r isle6_3_m13p, eval = F}
pm13 <- m13.glmer
fixef(pm13)["Age40+:Frequency"] <- 1.244 
estimatesfixedeffects <- fixef(pm13)
pm13_results <- simr::powerSim(pm13, fixed("Age40+:Frequency", "z"), nsim=100)
pm13_results
```

```{r isle6_3_m14a}
ifelse(min(ftable(verywsc$Age, verywsc$Priming, verywsc$very)) == 0, "not possible", "possible") 
m14.glmer <-  update(m10.glmer, .~.+ Age * Priming)
max(car::vif(m14.glmer)[,1])
anova(m14.glmer, m10.glmer, test = "Chi") 
Anova(m14.glmer, type = "III", test = "Chi") 
```

```{r isle6_3_m14b}
m14.glmer <-  update(m14.glmer, .~. -Gradability)
max(car::vif(m14.glmer)[,1])
anova(m14.glmer, m10.glmer, test = "Chi") 
Anova(m14.glmer, type = "III", test = "Chi") 
```

```{r isle6_3_m14p, eval = F}
pm14 <- m14.glmer
fixef(pm14)["Age40+:PrimingPrime"] <- 1.244 
estimatesfixedeffects <- fixef(pm14)
pm14_results <- simr::powerSim(pm14, fixed("Age40+:PrimingPrime", "z"), nsim=100)
pm14_results
```

```{r isle6_3_m15}
ifelse(min(ftable(verywsc$Age, verywsc$Emotionality, verywsc$very)) == 0, "not possible", "possible") 
m15.glmer <-  update(m14.glmer, .~.+ Age * Emotionality)
max(car::vif(m15.glmer)[,1])
# excessive vifs
```

```{r isle6_3_m16}
ifelse(min(ftable(verywsc$Age, verywsc$Type, verywsc$very)) == 0, "not possible", "possible") 
m16.glmer <-  update(m14.glmer, .~.+ Age * Type)
max(car::vif(m16.glmer)[,1])
# excessive vifs
```

```{r isle6_3_m17}
ifelse(min(ftable(verywsc$Age, verywsc$Gender, verywsc$very)) == 0, "not possible", "possible") 
m17.glmer <-  update(m14.glmer, .~.+ Age * Gender)
max(car::vif(m17.glmer)[,1])
# excessive vifs
```

```{r isle6_3_m18}
ifelse(min(ftable(verywsc$Age, verywsc$Ethnicity, verywsc$very)) == 0, "not possible", "possible") 
m18.glmer <-  update(m14.glmer, .~.+ Age * Ethnicity)
max(car::vif(m18.glmer)[,1])
# excessive vifs
```

```{r isle6_3_m19}
ifelse(min(ftable(verywsc$Age, verywsc$Education, verywsc$very)) == 0, "not possible", "possible")
m19.glmer <-  update(m14.glmer, .~.+ Age * Education)
max(car::vif(m19.glmer)[,1])
# excessive vifs
```

```{r isle6_3_m20}
m20.glmer <-  update(m14.glmer, .~.+ Age * Gradability)
max(car::vif(m20.glmer)[,1])
anova(m20.glmer, m14.glmer, test = "Chi") 
Anova(m20.glmer, type = "III", test = "Chi") 
```

```{r isle6_3_m20p, eval = F}
pm20 <- m20.glmer
fixef(pm20)["Age40+:Gradability"] <- 1.244 
estimatesfixedeffects <- fixef(pm20)
pm20_results <- simr::powerSim(pm20, fixed("Age40+:Gradability", "z"), nsim=100)
pm20_results
```

```{r isle6_3_m22}
m22.glmer <-  update(m14.glmer, .~.+ SemanticCategory * Frequency)
max(car::vif(m22.glmer)[,1])
# excessive vifs
```

```{r isle6_3_m23}
ifelse(min(ftable(verywsc$SemanticCategory, verywsc$Priming, verywsc$very)) == 0, "not possible", "possible")
m23.glmer <-  update(m14.glmer, .~.+ SemanticCategory * Priming)
max(car::vif(m23.glmer)[,1])
# excessive vifs
```

```{r isle6_3_m24}
ifelse(min(ftable(verywsc$SemanticCategory, verywsc$Emotionality, verywsc$very)) == 0, "not possible", "possible")
#m24.glmer <-  update(m14.glmer, .~.+ SemanticCategory * Emotionality)
#max(car::vif(m24.glmer)[,1])
```

```{r isle6_3_m25}
ifelse(min(ftable(verywsc$SemanticCategory, verywsc$Type, verywsc$very)) == 0, "not possible", "possible") 
m25.glmer <-  update(m14.glmer, .~.+ SemanticCategory * Type)
max(car::vif(m25.glmer)[,1])
# excessive vifs
```

```{r isle6_3_m26}
ifelse(min(ftable(verywsc$SemanticCategory, verywsc$Gender, verywsc$very)) == 0, "not possible", "possible") 
m26.glmer <-  update(m14.glmer, .~.+ SemanticCategory * Gender)
max(car::vif(m26.glmer)[,1])
# excessive vifs
```

```{r isle6_3_m27}
ifelse(min(ftable(verywsc$SemanticCategory, verywsc$Ethnicity, verywsc$very)) == 0, "not possible", "possible") 
m27.glmer <-  update(m14.glmer, .~.+ SemanticCategory * Ethnicity)
max(car::vif(m27.glmer)[,1])
# excessive vifs
```

```{r isle6_3_m28}
ifelse(min(ftable(verywsc$SemanticCategory, verywsc$Education, verywsc$very)) == 0, "not possible", "possible") 
m28.glmer <-  update(m14.glmer, .~.+ SemanticCategory * Education)
max(car::vif(m28.glmer)[,1])
# failure to converge
```

```{r isle6_3_m29}
m29.glmer <-  update(m14.glmer, .~.+ SemanticCategory * Gradability)
max(car::vif(m29.glmer)[,1])
# excessive vifs
```

```{r isle6_3_m31}
m31.glmer <-  update(m14.glmer, .~.+ Frequency * Priming)
max(car::vif(m31.glmer)[,1])
anova(m31.glmer, m14.glmer, test = "Chi")
Anova(m31.glmer, type = "III", test = "Chi") 
```

```{r isle6_3_m31p, eval = F}
pm31 <- m31.glmer
fixef(pm31)["PrimingPrime:Frequency"] <- 1.244 
estimatesfixedeffects <- fixef(pm31)
pm31_results <- simr::powerSim(pm31, fixed("PrimingPrime:Frequency", "z"), nsim=100)
pm31_results
```

```{r isle6_3_m32}
m32.glmer <-  update(m14.glmer, .~.+ Frequency * Emotionality)
max(car::vif(m32.glmer)[,1])
# excessive vifs
```

```{r isle6_3_m33}
m33.glmer <-  update(m14.glmer, .~.+ Frequency * Type)
max(car::vif(m33.glmer)[,1])
anova(m33.glmer, m14.glmer, test = "Chi")
Anova(m33.glmer, type = "III", test = "Chi") 
```

```{r isle6_3_m33p, eval = F}
pm33 <- m33.glmer
fixef(pm33)["TypePublicConversation:Frequency"] <- 1.244 
estimatesfixedeffects <- fixef(pm33)
pm33_results <- simr::powerSim(pm33, fixed("TypePublicConversation:Frequency", "z"), nsim=100)
pm33_results
```

```{r isle6_3_m34}
m34.glmer <-  update(m33.glmer, .~.+ Frequency * Gender)
max(car::vif(m34.glmer)[,1])
anova(m34.glmer, m33.glmer, test = "Chi")
```

```{r isle6_3_m34p, eval = F}
pm34 <- m34.glmer
fixef(pm34)["GenderWoman:Frequency"] <- 1.244 
estimatesfixedeffects <- fixef(pm34)
pm34_results <- simr::powerSim(pm34, fixed("GenderWoman:Frequency", "z"), nsim=100)
pm34_results
```

```{r isle6_3_m35}
m35.glmer <-  update(m33.glmer, .~.+ Frequency * Ethnicity)
max(car::vif(m35.glmer)[,1])
anova(m35.glmer, m33.glmer, test = "Chi")
```

```{r isle6_3_m35p, eval = F}
pm35 <- m35.glmer
fixef(pm35)["Frequency:EthnicityOther"] <- 1.244 
estimatesfixedeffects <- fixef(pm35)
pm35_results <- simr::powerSim(pm35, fixed("Frequency:EthnicityOther", "z"), nsim=100)
pm35_results
```

```{r isle6_3_m36}
m36.glmer <-  update(m33.glmer, .~.+ Frequency * Education)
max(car::vif(m36.glmer)[,1])
anova(m36.glmer, m33.glmer, test = "Chi")
```

```{r isle6_3_m36p, eval = F}
pm36 <- m36.glmer
fixef(pm36)["Frequency:EducationUniversity"] <- 1.244 
estimatesfixedeffects <- fixef(pm36)
pm36_results <- simr::powerSim(pm36, fixed("Frequency:EducationUniversity", "z"), nsim=100)
pm36_results
```

```{r isle6_3_m37}
m37.glmer <-  update(m33.glmer, .~.+ Frequency * Gradability)
max(car::vif(m37.glmer)[,1])
# falÃ­lure to converge
```

```{r isle6_3_m37p, eval = F}
pm37 <- m37.glmer
fixef(pm37)["Frequency:Gradability"] <- 1.244 
estimatesfixedeffects <- fixef(pm37)
pm37_results <- simr::powerSim(pm37, fixed("Frequency:Gradability", "z"), nsim=100)
pm37_results
```

```{r isle6_3_m39}
ifelse(min(ftable(verywsc$Priming, verywsc$Emotionality, verywsc$very)) == 0, "not possible", "possible") 
m39.glmer <-  update(m33.glmer, .~.+ Priming * Emotionality)
max(car::vif(m39.glmer)[,1])
# excessive vifs
```

```{r isle6_3_m40}
ifelse(min(ftable(verywsc$Priming, verywsc$Type, verywsc$very)) == 0, "not possible", "possible") 
m40.glmer <-  update(m33.glmer, .~.+ Priming * Type)
max(car::vif(m40.glmer)[,1])
# excessive vifs
```

```{r isle6_3_m41}
ifelse(min(ftable(verywsc$Priming, verywsc$Gender, verywsc$very)) == 0, "not possible", "possible") 
m41.glmer <-  update(m33.glmer, .~.+ Priming * Gender)
max(car::vif(m41.glmer)[,1])
anova(m41.glmer, m33.glmer, test = "Chi")
Anova(m41.glmer, type = "III", test = "Chi") 
```

```{r isle6_3_m41}
m41.glmer <-  update(m33.glmer, .~. -Type:Frequency)
max(car::vif(m41.glmer)[,1])
anova(m41.glmer, m33.glmer, test = "Chi")
Anova(m41.glmer, type = "III", test = "Chi") 
```

```{r isle6_3_m41p, eval = F}
pm41 <- m41.glmer
fixef(pm41)["PrimingPrime:GenderWoman"] <- 1.244 
estimatesfixedeffects <- fixef(pm41)
pm41_results <- simr::powerSim(pm41, fixed("PrimingPrime:GenderWoman", "z"), nsim=100)
pm41_results
```

```{r isle6_3_m42}
ifelse(min(ftable(verywsc$Priming, verywsc$Ethnicity, verywsc$very)) == 0, "not possible", "possible") 
m42.glmer <-  update(m41.glmer, .~.+ Priming * Ethnicity)
max(car::vif(m42.glmer)[,1])
# excessive vifs
```

```{r isle6_3_m43}
ifelse(min(ftable(verywsc$Priming, verywsc$Education, verywsc$very)) == 0, "not possible", "possible") 
m43.glmer <-  update(m41.glmer, .~.+ Priming * Education)
# failure to converge
```

```{r isle6_3_m44}
m44.glmer <-  update(m41.glmer, .~.+ Priming * Gradability)
max(car::vif(m44.glmer)[,1])
anova(m44.glmer, m41.glmer, test = "Chi")
```

```{r isle6_3_m44p, eval = F}
pm44 <- m44.glmer
fixef(pm44)["PrimingPrime:Gradability"] <- 1.244 
estimatesfixedeffects <- fixef(pm44)
pm44_results <- simr::powerSim(pm44, fixed("PrimingPrime:Gradability", "z"), nsim=100)
pm44_results
```

```{r isle6_3_m46}
ifelse(min(ftable(verywsc$Emotionality, verywsc$Type, verywsc$very)) == 0, "not possible", "possible") 
m46.glmer <-  update(m41.glmer, .~.+ Emotionality * Type)
max(car::vif(m46.glmer)[,1])
# excessive vifs
```

```{r isle6_3_m47}
ifelse(min(ftable(verywsc$Emotionality, verywsc$Gender, verywsc$very)) == 0, "not possible", "possible") 
m47.glmer <-  update(m41.glmer, .~.+ Emotionality * Gender)
max(car::vif(m47.glmer)[,1])
# excessive vifs
```

```{r isle6_3_m48}
ifelse(min(ftable(verywsc$Emotionality, verywsc$Ethnicity, verywsc$very)) == 0, "not possible", "possible") 
m48.glmer <-  update(m41.glmer, .~.+ Emotionality * Ethnicity)
max(car::vif(m48.glmer)[,1])
# excessive vifs
```

```{r isle6_3_m49}
ifelse(min(ftable(verywsc$Emotionality, verywsc$Education, verywsc$very)) == 0, "not possible", "possible") 
m49.glmer <-  update(m41.glmer, .~.+ Emotionality * Education)
max(car::vif(m49.glmer)[,1])
# excessive vifs
```

```{r isle6_3_m50}
m50.glmer <-  update(m41.glmer, .~.+ Emotionality * Gradability)
max(car::vif(m50.glmer)[,1])
# excessive vifs
```

```{r isle6_3_m52}
ifelse(min(ftable(verywsc$Type, verywsc$Gender, verywsc$very)) == 0, "not possible", "possible") 
m52.glmer <-  update(m41.glmer, .~.+ Type * Gender)
max(car::vif(m52.glmer)[,1])
# excessive vifs
```

```{r isle6_3_m53}
ifelse(min(ftable(verywsc$Type, verywsc$Ethnicity, verywsc$very)) == 0, "not possible", "possible") 
m53.glmer <-  update(m41.glmer, .~.+ Type * Ethnicity)
max(car::vif(m53.glmer)[,1])
# excessive vifs
```

```{r isle6_3_m54}
ifelse(min(ftable(verywsc$Type, verywsc$Education, verywsc$very)) == 0, "not possible", "possible") 
m54.glmer <-  update(m41.glmer, .~.+ Type * Education)
max(car::vif(m54.glmer)[,1])
# excessive vifs
```

```{r isle6_3_m55}
m55.glmer <-  update(m41.glmer, .~.+ Type * Gradability)
max(car::vif(m55.glmer)[,1])
# excessive vifs
```

```{r isle6_3_m57}
ifelse(min(ftable(verywsc$Gender, verywsc$Ethnicity, verywsc$very)) == 0, "not possible", "possible") 
m57.glmer <-  update(m41.glmer, .~.+ Gender * Ethnicity)
max(car::vif(m57.glmer)[,1])
# excessive vifs
```

```{r isle6_3_m58a}
ifelse(min(ftable(verywsc$Gender, verywsc$Education, verywsc$very)) == 0, "not possible", "possible") 
m58.glmer <-  update(m41.glmer, .~.+ Gender * Education)
max(car::vif(m58.glmer)[,1])
anova(m58.glmer, m41.glmer, test = "Chi") 
Anova(m58.glmer, type = "III", test = "Chi") 
```

```{r isle6_3_m58b}
m58.glmer <-  update(m58.glmer, .~.-Frequency)
max(car::vif(m58.glmer)[,1])
anova(m58.glmer, m41.glmer, test = "Chi") 
Anova(m58.glmer, type = "III", test = "Chi") 
```

```{r isle6_3_m58c}
m58.glmer <-  update(m58.glmer, .~.-Emotionality)
max(car::vif(m58.glmer)[,1])
anova(m58.glmer, m41.glmer, test = "Chi") 
Anova(m58.glmer, type = "III", test = "Chi") 
```

```{r isle6_3_m58p, eval = F}
pm58 <- m58.glmer
fixef(pm58)["GenderWoman:EducationUniversity"] <- 1.244 
estimatesfixedeffects <- fixef(pm58)
pm58_results <- simr::powerSim(pm58, fixed("GenderWoman:EducationUniversity", "z"), nsim=100)
pm58_results
```

```{r isle6_3_m59}
m59.glmer <-  update(m58.glmer, .~.+ Gender * Gradability)
max(car::vif(m59.glmer)[,1])
anova(m59.glmer, m58.glmer, test = "Chi") 
```

```{r isle6_3_m59p, eval = F}
pm59 <- m59.glmer
fixef(pm59)["GenderWoman:Gradability"] <- 1.244 
estimatesfixedeffects <- fixef(pm59)
pm59_results <- simr::powerSim(pm59, fixed("GenderWoman:Gradability", "z"), nsim=100)
pm59_results
```

```{r isle6_3_m62}
ifelse(min(ftable(verywsc$Ethnicity, verywsc$Education, verywsc$very)) == 0, "not possible", "possible") 
m61.glmer <-  update(m58.glmer, .~.+ Ethnicity * Education)
max(car::vif(m61.glmer)[,1])
# excessive vifs
```

```{r isle6_3_m63}
m62.glmer <-  update(m58.glmer, .~.+ Ethnicity * Gradability)
max(car::vif(m62.glmer)[,1])
# excessive vifs
```

```{r isle6_3_m64}
m64.glmer <-  update(m58.glmer, .~.+ Education * Gradability)
max(car::vif(m64.glmer)[,1])
anova(m64.glmer, m58.glmer, test = "Chi") 
```

```{r isle6_3_m64p, eval = F}
pm64 <- m64.glmer
fixef(pm64)["EducationUniversity:Gradability"] <- 1.244 
estimatesfixedeffects <- fixef(pm64)
pm64_results <- simr::powerSim(pm64, fixed("EducationUniversity:Gradability", "z"), nsim=100)
pm64_results
```

## Diagnostics{-}

```{r isle6_3_41, message=F, warning=F}
plot(m58.glmer, col = "black", pch = 20); par(mfrow = c(1, 1))
```

## Model fitting summary{-}

In a next step, we create a summary of the model fitting process.

```{r isle6_3_46,  message=F, warning=F}
# use customized model comparison function
# create compariveryns
m1m0 <- anova(m0.glmer, m1.glmer, test = "Chi")
m2m1 <- anova(m2.glmer, m1.glmer, test = "Chi") 
m3m1 <- anova(m3.glmer, m1.glmer, test = "Chi")              
m4m3 <- anova(m4.glmer, m3.glmer, test = "Chi")              
m5m4 <- anova(m5.glmer, m4.glmer, test = "Chi") 
m6m5 <- anova(m6.glmer, m5.glmer, test = "Chi")              
m7m6 <- anova(m7.glmer, m6.glmer, test = "Chi") 
m8m6 <- anova(m8.glmer, m6.glmer, test = "Chi")  
m9m6 <- anova(m9.glmer, m6.glmer, test = "Chi")       
m10m6 <- anova(m10.glmer, m6.glmer, test = "Chi")   
m13m10 <- anova(m13.glmer, m10.glmer, test = "Chi") 
m14m10 <- anova(m14.glmer, m10.glmer, test = "Chi") 
m20m14 <- anova(m20.glmer, m14.glmer, test = "Chi") 
m31m14 <- anova(m31.glmer, m14.glmer, test = "Chi")
m33m14 <- anova(m33.glmer, m14.glmer, test = "Chi")
m34m33 <- anova(m34.glmer, m33.glmer, test = "Chi")
m35m33 <- anova(m35.glmer, m33.glmer, test = "Chi")
m36m33 <- anova(m36.glmer, m33.glmer, test = "Chi")
m41m33 <- anova(m41.glmer, m33.glmer, test = "Chi")
m44m41 <- anova(m44.glmer, m41.glmer, test = "Chi")
m58m41 <- anova(m58.glmer, m41.glmer, test = "Chi")  
m59m58 <- anova(m59.glmer, m58.glmer, test = "Chi") 
m64m58 <- anova(m64.glmer, m58.glmer, test = "Chi") 

# create a list of the model compariveryns
mdlcmp <- list(m1m0, m2m1, m3m1, m4m3, m5m4, m6m5, m7m6, m8m6, m9m6, m10m6, m13m10, 
               m14m10, m20m14, m31m14, m33m14, m34m33, m35m33, m36m33, m41m33, m44m41, 
               m58m41, m59m58, m64m58)
# load function
source("D:\\R/ModelFittingSummarySWSU.R") # for Mixed Effects Model fitting (step-wise step-up): Binary Logistic Mixed Effects Models
# apply function
mdl.cmp.glmersc.swsu.dm <- mdl.fttng.swsu(mdlcmp)
# save comparisons to disc
write.table(mdl.cmp.glmersc.swsu.dm, here::here("data", "mdl_cmp_glmersc_swsu_verywscnew.txt"), sep="\t")
# inspect output
mdl.cmp.glmersc.swsu.dm
```

# Model summary

```{r isle6_3_glm}
m58.glm <-  glm(very ~ Age + Priming + Emotionality + Type + Gender + Education + Age:Priming + Gender:Education, 
                family = "binomial", data = verywsc)
```

```{r isle6_3_42, message=F, warning=F}
# load function for regression table summary
source("D:\\R/meblr.summary.R")
# set up summary table
meblrm_ampwsc <- meblrm.summary(m0.glm, m58.glm, m0.glmer, m58.glmer, verywsc$very) 
# save results to disc
write.table(meblrm_ampwsc, here::here("data", "meblrm_ampwsc.txt"), sep="\t")
# inspect result summary
meblrm_ampwsc
```

We also check the Anova summary to see if predictors, rather than individual predictor levels, are significant and to what extent.

```{r isle6_3_43, message=F, warning=F}
# load function
library(car)
meblrm_ampwsc_Anova <- Anova(m58.glmer, type = "III", test = "Chi")
# save results to disc
write.table(meblrm_ampwsc_Anova, here::here("data", "meblrm_ampwsc_Anova.txt") , sep="\t")
# inspect results in Anova style
meblrm_ampwsc_Anova
```

Visualize effects

```{r isle6_3_44, message=F, warning=F}
sjPlot::plot_model(m58.glmer) +
  theme_bw() + 
  geom_hline(yintercept = 1, linetype = "dotted") +
  theme(legend.position = "top",
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(), 
        axis.line = element_line(colour = "black")) +
  labs(title = "Odds Ratio of very")+
  ggsave(file =  here::here("images", "Effects.png"), 
         width = 20, height = 10, units = c("cm"),  dpi = 600)
```

```{r isle6_3_45g, message=F, warning=F}
sjPlot::tab_model(m0.glmer, m1.glmer, m58.glmer,
                  dv.labels = c("Intercept-only Model", "Age-only Model", "Final Minimal Model"),
                  p.style = "stars", collapse.ci = TRUE)
```

## C and Somers D{-}

```{r}
pred_m0 <- ifelse(fitted(m0.glmer) >= .5, 1, 0)
pred_m1 <- ifelse(fitted(m1.glmer) >= .5, 1, 0)
pred_mf <- ifelse(fitted(m58.glmer) >= .5, 1, 0)
obs <- ifelse(verywsc$very == "very", 1, 0)
somers2(obs, pred_m0)
somers2(obs, pred_m1)
somers2(obs, pred_mf)
```

Inspect probabilities

```{r}
feffects <- names(fixef(m58.glmer))
loggedodds <- c(fixef(m58.glmer)[1],
          fixef(m58.glmer)[1] + fixef(m58.glmer)[2:length(fixef(m58.glmer))])
probs <- plogis(loggedodds) 
ptb <- data.frame(feffects, probs)
ptb
```

###Post-Hoc tests{-}

Age

```{r isle6_3_48, message=F, warning=F}
library (multcomp)
summary(glht(m58.glmer, mcp(Age="Tukey")))
```

Type

```{r isle6_3_49, message=F, warning=F}
summary(glht(m58.glmer, mcp(Type="Tukey")))
```

## Check accuracy{-}

```{r isle6_3_50, message=F, warning=F}
# predict probs of nativelike for effects
verywsc$PredictedFrequency <- predict(m58.glmer, verywsc, type="response")
# create response variable
verywsc$PredictedResponse <- ifelse(verywsc$PredictedFrequency > .5, "very", "other")
#summary(verywscnew$PredictedResponse)
# load library
library(caret)
# create confusion matrix
confusionMatrix(as.factor(verywsc$PredictedResponse), as.factor(verywsc$very))
```

```{r isle6_3_50, message=F, warning=F}
# predict probs of nativelike for effects
verywsc$PredictedFrequency <- predict(m1.glmer, verywsc, type="response")
# create response variable
verywsc$PredictedResponse <- ifelse(verywsc$PredictedFrequency > .5, "very", "other")
#summary(verywscnew$PredictedResponse)
# load library
library(caret)
# create confusion matrix
confusionMatrix(as.factor(verywsc$PredictedResponse), as.factor(verywsc$very))
```

## Visualize effects{.}

```{r isle6_3_54, message=F, warning=F}
sjPlot::plot_model(m58.glmer, type = "pred", 
                   terms = c("Gender", "Education")) +
  theme_bw() +
  theme(legend.position = "top",
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(), 
        axis.line = element_line(colour = "black"),
        legend.title = element_blank()) +
  scale_y_continuous(name = "Predicted Probabilty of VERY", 
                     limits = c(0, 1),
                     breaks = seq(0, 1, .20), 
                     labels = seq(0, 1, .20)) +
  labs(title = "") +
  ggsave(file =  here::here("images", "Effect_Gender_Education.png"), 
         width = 7.5, height = 15, units = c("cm"),  dpi = 600)
```

```{r isle6_3_53, message=F, warning=F}
sjPlot::plot_model(m58.glmer, type = "pred", terms = c("Age", "Priming")) +
  theme_bw() +
  theme(legend.position = "top",
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(), 
        axis.line = element_line(colour = "black"),
        legend.title = element_blank()) +
  scale_y_continuous(name = "Predicted Probabilty of VERY", 
                     limits = c(0, 1),
                     breaks = seq(0, 1, .20), 
                     labels = seq(0, 1, .20)) +
  labs(title = "") +
  ggsave(file =  here::here("images", "Effect_Age_Priming.png"), 
         width = 7.5, height = 15, units = c("cm"),  dpi = 600)
```

```{r isle6_3_55, message=F, warning=F}
sjPlot::plot_model(m58.glmer, type = "pred", terms = c("Type")) +
  theme_bw() +
  theme(legend.position = "top",
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(), 
        axis.line = element_line(colour = "black"),
        legend.title = element_blank()) +
  scale_y_continuous(name = "Predicted Probabilty of VERY", 
                     limits = c(0, 1),
                     breaks = seq(0, 1, .20), 
                     labels = seq(0, 1, .20)) +
  labs(title = "") +
  ggsave(file =  here::here("images", "Effect_Type.png"), 
         width = 7.5, height = 13, units = c("cm"),  dpi = 600)
```

```{r isle6_3_55, message=F, warning=F}
sjPlot::plot_model(m58.glmer, type = "pred", terms = c("Emotionality")) +
  theme_bw() +
  theme(legend.position = "top",
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(), 
        axis.line = element_line(colour = "black")) +
  scale_y_continuous(name = "Predicted Probabilty of VERY", 
                     limits = c(0, 1),
                     breaks = seq(0, 1, .20), 
                     labels = seq(0, 1, .20)) +
  labs(title = "") +
  ggsave(file =  here::here("images", "Effect_Emotionality.png"), 
         width = 10, height = 10, units = c("cm"),  dpi = 600)
```

```{r isle6_3_57, message=F, warning=F}
randomtb <- ranef(m58.glmer)
rndmadj <- as.vector(unlist(randomtb$`Adjective`))
adj <- as.vector(unlist(rownames(randomtb$`Adjective`)))
rndmadjtb <- data.frame(adj, rndmadj)
colnames(rndmadjtb) <- c("Adjective", "Intercept")
rndmadjtb <- rndmadjtb[order(rndmadjtb$Intercept, decreasing = T),]
# inspect
head(rndmadjtb)
```

```{r isle6_3_58, message=F, warning=F}
ggplot(rndmadjtb, aes(Adjective, Intercept)) +
  geom_point(aes(reorder(Adjective, -Intercept, fun = Intercept), y=Intercept)) +
  coord_cartesian(ylim = c(-4, 4)) +
  theme_set(theme_bw(base_size = 15)) +
  theme(legend.position="none", 
        axis.text.x = element_text(size=15, angle=90),
        panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank()) +
  scale_x_discrete(breaks = rndmadjtb$Adjective[seq(1,length(rndmadjtb$Adjective),9)]) +
  labs(x = "Adjective type \n(only selected labels displayed)", y = "Adjustment to Intercept") +
  ggsave(file = here::here("images", "RandomEffects_Adjective.png"), 
       height = 5,  width = 7.5,  dpi = 320)
```

```{r isle6_3_60, message=F, warning=F}
rndmadjtb %>%
  dplyr::filter(Intercept > 2 | Intercept < -2) %>%
  ggplot(aes(Adjective, Intercept)) +
  geom_point(aes(reorder(Adjective, -Intercept, fun = Intercept), y=Intercept)) +
  coord_cartesian(ylim = c(-4, 4)) +
  theme_set(theme_bw(base_size = 15)) +
  theme(legend.position="none", 
        axis.text.x = element_text(size=15, angle=90),
        panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank()) +
  labs(x = "Adjective type \n(only selected labels displayed)", y = "Adjustment to Intercept") +
  ggsave(file = here::here("images", "RandomEffects_Adjective_redux.png"), 
       height = 5,  width = 7.5,  dpi = 320)
```

# Citation & Session Info {-}

Schweinberger, Martin. `r format(Sys.time(), '%Y')`. *On the waning of forms - a corpus-based analysis of losers in language change (Part 3)*. Brisbane: The University of Queensland. url: https://slcladal.github.io/isle6verynze.html (Version `r format(Sys.time(), '%Y.%m.%d')`).

```
@manual{schweinberger`r format(Sys.time(), '%Y')`isle6verynze,
  author = {Schweinberger, Martin},
  title = {On the waning of forms - a corpus-based analysis of losers in language change (Part 3)},
  note = {https://slcladal.github.io/isle6verynze.html},
  year = {`r format(Sys.time(), '%Y')`},
  organization = {The University of Queensland, School of Languages and Cultures},
  address = {Brisbane},
  edition = {`r format(Sys.time(), '%Y.%m.%d')`}
}
```

```{r fin}
sessionInfo()
```

***

[Back to top](#introduction)

***

# References {-}

